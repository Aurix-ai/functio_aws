2025-11-28 20:59:03 - INFO - __main__: ============================================================
2025-11-28 20:59:03 - INFO - __main__: New request received at 11-28_20-59-03
2025-11-28 20:59:03 - INFO - __main__: ============================================================
2025-11-28 20:59:03 - INFO - __main__: Starting ClickHouse server...
2025-11-28 20:59:09 - INFO - __main__: ClickHouse server started successfully
2025-11-28 20:59:09 - INFO - __main__: Received 3 queries
2025-11-28 20:59:09 - INFO - __main__: Waiting for server to be ready...
2025-11-28 20:59:09 - INFO - __main__: Server is ready
2025-11-28 20:59:09 - INFO - __main__: Executing 2 setup queries...
2025-11-28 20:59:09 - INFO - __main__: Executing setup query 1/2: CREATE TABLE stress_arrays_3 (
    id UInt64,
    seed_val UInt64
) ENGINE = MergeTree()
ORDER BY id...
2025-11-28 20:59:10 - INFO - __main__: Setup query 1 completed successfully
2025-11-28 20:59:10 - INFO - __main__: Executing setup query 2/2: INSERT INTO stress_arrays_3
SELECT 
    number, 
    rand() 
FROM numbers(1000000);...
2025-11-28 20:59:10 - INFO - __main__: Setup query 2 completed successfully
2025-11-28 20:59:10 - INFO - __main__: Main query to analyze: SELECT 
    id, 
    expanded_val, 
    uniqExact(expanded_val) 
FROM stress_arrays_3
ARRAY JOIN range(id % 100) AS expanded_val 
WHERE id > 0
GROUP BY id, expanded_val
ORDER BY expanded_val DESC
LIMIT 1000;
2025-11-28 20:59:10 - INFO - __main__: Starting flamegraph analysis (unified_strategy)...
2025-11-28 20:59:10 - INFO - STDOUT: [*] Running flame_folded_pid.sh for PID: 2507229
2025-11-28 20:59:10 - INFO - STDOUT: Executable command is /home/ubuntu/ClickHouse_debug/build_debug/programs/clickhouse client --query 'SELECT 
2025-11-28 20:59:10 - INFO - STDOUT:     id, 
2025-11-28 20:59:10 - INFO - STDOUT:     expanded_val, 
2025-11-28 20:59:10 - INFO - STDOUT:     uniqExact(expanded_val) 
2025-11-28 20:59:10 - INFO - STDOUT: FROM stress_arrays_3
2025-11-28 20:59:10 - INFO - STDOUT: ARRAY JOIN range(id % 100) AS expanded_val 
2025-11-28 20:59:10 - INFO - STDOUT: WHERE id > 0
2025-11-28 20:59:10 - INFO - STDOUT: GROUP BY id, expanded_val
2025-11-28 20:59:10 - INFO - STDOUT: ORDER BY expanded_val DESC
2025-11-28 20:59:10 - INFO - STDOUT: LIMIT 1000;'
2025-11-28 20:59:10 - INFO - STDOUT: successfully ran flame_folded_pid.sh
2025-11-28 21:00:18 - INFO - STDOUT: [âœ“] FlameGraph folded file generated successfully
2025-11-28 21:01:25 - INFO - __main__: ============================================================
2025-11-28 21:01:25 - INFO - __main__: New request received at 11-28_21-01-25
2025-11-28 21:01:25 - INFO - __main__: ============================================================
2025-11-28 21:01:26 - INFO - __main__: Starting ClickHouse server...
2025-11-28 21:11:18 - ERROR - STDERR: Exception ignored in: <module 'threading' from '/usr/lib/python3.12/threading.py'>
2025-11-28 21:11:18 - ERROR - STDERR: Traceback (most recent call last):
2025-11-28 21:11:18 - ERROR - STDERR:   File "/usr/lib/python3.12/threading.py", line 1622, in _shutdown
2025-11-28 21:11:19 - ERROR - STDERR:     lock.acquire()
2025-11-28 21:11:19 - ERROR - STDERR: KeyboardInterrupt: 
