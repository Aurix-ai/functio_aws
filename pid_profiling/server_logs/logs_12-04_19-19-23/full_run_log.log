2025-12-04 19:19:23 - INFO - __main__: ============================================================
2025-12-04 19:19:23 - INFO - __main__: New request received at 12-04_19-19-23
2025-12-04 19:19:23 - INFO - __main__: ============================================================
2025-12-04 19:19:23 - INFO - __main__: Starting ClickHouse server...
2025-12-04 19:19:29 - INFO - __main__: ClickHouse server started successfully
2025-12-04 19:19:29 - INFO - __main__: Received 1 queries
2025-12-04 19:19:29 - INFO - __main__: Waiting for server to be ready...
2025-12-04 19:19:30 - INFO - __main__: Server is ready
2025-12-04 19:19:30 - INFO - __main__: Executing 0 setup queries...
2025-12-04 19:19:30 - INFO - __main__: Main query to analyze: select sumIf(number::Decimal128(3), rand32() % 2 = 0) from numbers(10000000000)
2025-12-04 19:19:30 - INFO - __main__: Starting flamegraph analysis (unified_strategy)...
2025-12-04 19:19:30 - INFO - STDOUT: [*] Running flame_folded_pid.sh for PID: 2999970
2025-12-04 19:19:30 - INFO - STDOUT: Executable command is /home/ubuntu/ClickHouse_debug/build_debug/programs/clickhouse client --query 'select sumIf(number::Decimal128(3), rand32() % 2 = 0) from numbers(10000000000)'
2025-12-04 19:19:30 - INFO - STDOUT: successfully ran flame_folded_pid.sh
2025-12-04 19:29:30 - ERROR - STDERR: Error: FlameGraph generation timed out after 300 seconds
2025-12-04 19:29:30 - ERROR - STDERR: stdout: [*] Recording perf data for PID: 2999970 while executing: /home/ubuntu/ClickHouse_debug/build_debug/programs/clickhouse client --query 'select sumIf(number::Decimal128(3), rand32() % 2 = 0) from numbers(10000000000)'
2025-12-04 19:29:30 - ERROR - STDERR: [*] Executing command: /home/ubuntu/ClickHouse_debug/build_debug/programs/clickhouse client --query 'select sumIf(number::Decimal128(3), rand32() % 2 = 0) from numbers(10000000000)'
2025-12-04 19:29:30 - ERROR - STDERR: Error in unified_strategy: Command '['sudo', './flame_folded_pid.sh', '--pid', '2999970', '--', "/home/ubuntu/ClickHouse_debug/build_debug/programs/clickhouse client --query 'select sumIf(number::Decimal128(3), rand32() % 2 = 0) from numbers(10000000000)'"]' timed out after 600 seconds
2025-12-04 19:29:30 - ERROR - __main__: Flamegraph analysis failed: Command '['sudo', './flame_folded_pid.sh', '--pid', '2999970', '--', "/home/ubuntu/ClickHouse_debug/build_debug/programs/clickhouse client --query 'select sumIf(number::Decimal128(3), rand32() % 2 = 0) from numbers(10000000000)'"]' timed out after 600 seconds
Traceback (most recent call last):
  File "/home/ubuntu/functio_server/pid_profiling/functio_server.py", line 118, in process_data
    hot_functions = unified_strategy(
                    ^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/functio_server/pid_profiling/unified_analysis.py", line 993, in unified_strategy
    raise e
  File "/home/ubuntu/functio_server/pid_profiling/unified_analysis.py", line 969, in unified_strategy
    folded_path = run_flamegraph(executable_command='/home/ubuntu/ClickHouse_debug/build_debug/programs/clickhouse client --query ' + shlex.quote(query), pid=pid, output_base=output_base)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/functio_server/pid_profiling/unified_analysis.py", line 139, in run_flamegraph
    result = subprocess.run(cmd_args, capture_output=True, timeout=600)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 550, in run
    stdout, stderr = process.communicate(input, timeout=timeout)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 1209, in communicate
    stdout, stderr = self._communicate(input, endtime, timeout)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/subprocess.py", line 2116, in _communicate
    self._check_timeout(endtime, orig_timeout, stdout, stderr)
  File "/usr/lib/python3.12/subprocess.py", line 1253, in _check_timeout
    raise TimeoutExpired(
subprocess.TimeoutExpired: Command '['sudo', './flame_folded_pid.sh', '--pid', '2999970', '--', "/home/ubuntu/ClickHouse_debug/build_debug/programs/clickhouse client --query 'select sumIf(number::Decimal128(3), rand32() % 2 = 0) from numbers(10000000000)'"]' timed out after 600 seconds
